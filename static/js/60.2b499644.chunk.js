(window.webpackJsonpjianghu=window.webpackJsonpjianghu||[]).push([[60],{2029:function(e,t,a){"use strict";a.r(t);a(1026);var n,r=a(1027),i=(a(277),a(117)),l=(a(274),a(112)),c=(a(206),a(47)),s=a(6),d=a.n(s),o=(a(100),a(23)),m=a(15),u=a(28),p=a(29),h=a(31),v=a(30),k=a(32),E=(a(436),a(207)),g=(a(154),a(79)),f=a(0),b=a.n(f),y=a(110),O=a(56),x=a(2030),j=a.n(x),D=(a(2031),a(41)),w=g.a.confirm,I=E.a.TabPane,C=Object(O.b)(function(e){return{userInfo:e.userInfo}}),P=[],A=C(n=Object(y.a)(n=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={allDepartmentObj:{},expandAll:!1},a.getAllDepartmentList=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(D.O)();case 2:200===(t=e.sent).code?a.initDepartment(t.data||[]):o.a.warning(t.msg);case 4:case"end":return e.stop()}},e)})),a.departmentClick=function(e,t){console.log(e,t)},a.onExpand=function(e,t){console.log(e,t),t.expand=!t.expand,a.setState({allDepartmentObj:a.state.allDepartmentObj})},a.menuClick=function(e,t){e.item;var n=e.key;e.keyPath,e.domEvent;switch(console.log(n,t),n){case"add":if(t.expand=!0,0===t.children.filter(function(e){return!0===e.isAdd}).length){var r={id:t.id+"_add",level:t.level+1,title:"\u65b0\u589e\u90e8\u95e8",expand:!1,isAdd:!0};r.label=b.a.createElement("div",{className:"custom"},r.title,b.a.createElement(i.a,{overlay:b.a.createElement(c.a,{onClick:function(e){var n=e.item,r=e.key,i=e.keyPath,l=e.domEvent;return a.menuClick({item:n,key:r,keyPath:i,domEvent:l},t)}},b.a.createElement(c.a.Item,{key:"cancelAdd"},"\u53d6\u6d88")),trigger:["contextMenu"]},b.a.createElement("div",{className:"right-click"},b.a.createElement(l.a,{onPressEnter:function(e){return a.pressEnter(e,"add",t)},style:{width:"100%",height:"100%"},placeholder:"\u90e8\u95e8\u540d\u79f0"})))),t.children.push(r)}a.setState({allDepartmentObj:a.state.allDepartmentObj});break;case"del":w({title:"\u5220\u9664\u90e8\u95e8?",content:"\u786e\u8ba4\u5220\u9664 ".concat(t.title," \u90e8\u95e8\u5417\uff1f"),onOk:function(){var e=Object(m.a)(d.a.mark(function e(){var n,r,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(D.q)({id:t.id});case 2:200===(n=e.sent).code?(o.a.success(n.msg),r=t.parentId,a.searchChildren(r,""),i=P.findIndex(function(e){return e.id===t.id}),P.splice(i,1),a.setState({allDepartmentObj:a.state.allDepartmentObj})):o.a.warning(n.msg);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()});break;case"edit":t.isEdit=!0,a.initDepartment(a.state.allDepartmentObj.children||[]);break;case"cancelEdit":t.isEdit=!1,a.initDepartment(a.state.allDepartmentObj.children||[]);break;case"cancelAdd":t.children.pop(),a.setState({allDepartmentObj:a.state.allDepartmentObj})}},a.pressEnter=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,s,m,u,p,h,v=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.length>1&&void 0!==v[1]?v[1]:"",r=v.length>2?v[2]:void 0,s=t.target.value){e.next=5;break}return e.abrupt("return",o.a.warning("\u90e8\u95e8\u540d\u79f0\u4e0d\u5f97\u4e3a\u7a7a"));case 5:if("add"!==n){e.next=13;break}return console.log(t.target.value,n,r),e.next=9,Object(D.e)({name:s,parentId:r.id});case 9:200===(m=e.sent).code?(o.a.success(m.msg),u=m.data,(p={id:u.id,level:r.level+1,title:u.name,expand:!1,isEdit:!1,children:[]}).label=b.a.createElement("div",{className:"custom"},p.title,b.a.createElement(i.a,{overlay:b.a.createElement(c.a,{onClick:function(e){var t=e.item,n=e.key,r=e.keyPath,i=e.domEvent;return a.menuClick({item:t,key:n,keyPath:r,domEvent:i},p)}},b.a.createElement(c.a.Item,{key:"add"},"\u65b0\u589e\u5b50\u90e8\u95e8"),p.isEdit?b.a.createElement(c.a.Item,{key:"cancelEdit"},"\u53d6\u6d88\u7f16\u8f91"):b.a.createElement(c.a.Item,{key:"edit"},"\u7f16\u8f91\u6b64\u90e8\u95e8"),b.a.createElement(c.a.Item,{key:"del"},"\u5220\u9664\u6b64\u90e8\u95e8")),trigger:["contextMenu"]},b.a.createElement("div",{className:"right-click"},p.isEdit&&b.a.createElement(l.a,{onPressEnter:function(e){return a.pressEnter(e,"edit",p)},style:{width:"100%",height:"100%"},placeholder:"\u90e8\u95e8\u540d\u79f0",defaultValue:p.title})))),r.children.pop(),r.children.push(p),a.setState({allDepartmentObj:a.state.allDepartmentObj})):o.a.warning(m.msg),e.next=19;break;case 13:if("edit"!==n){e.next=19;break}return console.log(t.target.value,n,r),e.next=17,Object(D.Ib)({id:r.id,name:s});case 17:200===(h=e.sent).code?(o.a.success(h.msg),r.title=s,r.isEdit=!1,a.initDepartment(a.state.allDepartmentObj.children||[])):o.a.warning(h.msg);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(k.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.state,t=e.allDepartmentObj,a=e.expandAll;return b.a.createElement("div",{id:"organManage_box"},b.a.createElement(E.a,null,b.a.createElement(I,{tab:b.a.createElement("span",null,"\u90e8\u95e8\u7ba1\u7406"),key:"userList"},b.a.createElement(r.a,{message:"\u201c\u53f3\u51fb\u201d\u90e8\u95e8\u53ef\u8fdb\u884c\u65b0\u589e\u5b50\u90e8\u95e8\u3001\u7f16\u8f91\u90e8\u95e8\u3001\u5220\u9664\u90e8\u95e8\u7b49\u64cd\u4f5c\u3002"}),a&&b.a.createElement(j.a,{data:t,horizontal:!0,collapsable:!0,onClick:this.departmentClick,onExpand:this.onExpand}))))}},{key:"componentDidMount",value:function(){this.getAllDepartmentList()}},{key:"initDepartment",value:function(e){var t=this,a={id:0,level:0,label:b.a.createElement("div",{className:"custom"},"\u5168\u90e8\u90e8\u95e8",b.a.createElement(i.a,{overlay:b.a.createElement(c.a,{onClick:function(e){var n=e.item,r=e.key,i=e.keyPath,l=e.domEvent;return t.menuClick({item:n,key:r,keyPath:i,domEvent:l},a)}},b.a.createElement(c.a.Item,{key:"add"},"\u65b0\u589e\u5b50\u90e8\u95e8")),trigger:["contextMenu"]},b.a.createElement("div",{className:"right-click"}))),expand:!0,children:this.dealDepartment(e)};console.log(this.dealDepartment(e)),this.setState({allDepartmentObj:a,expandAll:!0})}},{key:"dealDepartment",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.map(function(t){var s={id:t.id||t.key,level:n,title:t.title,expand:t.expand||!1,isEdit:t.isEdit||!1,children:e.dealDepartment(t.children||[],[],n+1,t.id||t.key),parentId:r};s.label=b.a.createElement("div",{className:"custom"},t.title,b.a.createElement(i.a,{overlay:b.a.createElement(c.a,{onClick:function(t){var a=t.item,n=t.key,r=t.keyPath,i=t.domEvent;return e.menuClick({item:a,key:n,keyPath:r,domEvent:i},s)}},b.a.createElement(c.a.Item,{key:"add"},"\u65b0\u589e\u5b50\u90e8\u95e8"),t.isEdit?b.a.createElement(c.a.Item,{key:"cancelEdit"},"\u53d6\u6d88\u7f16\u8f91"):b.a.createElement(c.a.Item,{key:"edit"},"\u7f16\u8f91\u6b64\u90e8\u95e8"),b.a.createElement(c.a.Item,{key:"del"},"\u5220\u9664\u6b64\u90e8\u95e8")),trigger:["contextMenu"]},b.a.createElement("div",{className:"right-click"},t.isEdit&&b.a.createElement(l.a,{onPressEnter:function(t){return e.pressEnter(t,"edit",s)},style:{width:"100%",height:"100%"},placeholder:"\u90e8\u95e8\u540d\u79f0",defaultValue:t.title})))),a.push(s)}),a}},{key:"searchChildren",value:function(e,t){var a=this.state.allDepartmentObj;if(t=t||a.children,0!==e)for(var n in t){if(t[n].id===e)return void(P=t[n].children);this.searchChildren(e,t[n].children)}else P=t}},{key:"addOrgan",value:function(){var e=Object(m.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.organ_name){e.next=3;break}return e.abrupt("return",o.a.warning("\u7ec4\u7ec7\u540d\u79f0\u4e0d\u5f97\u4e3a\u7a7a"));case 3:return e.next=5,Object(D.f)({name:t});case 5:200===(a=e.sent).code?(o.a.success(a.msg),this.setState({organ_name:""}),this.getAllOrgans()):o.a.warning(a.msg);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(f.Component))||n)||n;t.default=A},2031:function(e,t,a){var n=a(2032);"string"===typeof n&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};a(86)(n,r);n.locals&&(e.exports=n.locals)},2032:function(e,t,a){(e.exports=a(85)(!1)).push([e.i,".org-tree-node-label-inner {\n  position: relative !important;\n}\n.custom >.right-click {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n  background-color: transparent;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n",""])}}]);