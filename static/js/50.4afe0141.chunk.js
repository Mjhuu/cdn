(window.webpackJsonpjianghu=window.webpackJsonpjianghu||[]).push([[50],{1179:function(e,t){e.exports="data:image/gif;base64,R0lGODlhCgAKAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJBAABACwAAAAACgAKAAACEIyPqcsM4GB4iM4nLc5c8wIAIfkECQQAAQAsAAAAAAoACgAAAhGMj6mrAOxMPNPVFyy+V1rvFQAh+QQJBAABACwAAAAACgAKAAACE4yPqQew0UxkDrY6L96Zb3mBYAEAIfkECQQAAQAsAAAAAAoACgAAAhSMjwiQt/YcCyvaCmfV/GZPYWFWAAAh+QQJBAABACwAAAAACgAKAAACFIyPeQDIxl6QsU1bIY5a0/15m1YAACH5BAkEAAEALAAAAAAKAAoAAAIUjI+ZAMpsYHhtVhrvy1n6bXVaVgAAIfkECQQAAQAsAAAAAAoACgAAAhOMjwCYy6aeioFOZyfEuvK8gV4BACH5BAkEAAEALAAAAAAKAAoAAAISjI+ZAGrsAlysSVuxnry+rX0FACH5BAkEAAEALAAAAAAKAAoAAAIRjI+pawDs4EsuBlsnrk3z6xUAIfkECQQAAQAsAAAAAAoACgAAAhCMj6nLCMBehOnJcC3N1vACACH5BAkEAAEALAAAAAAKAAoAAAIPjI+py50AGJTxwTrDxbwAACH5BAkEAAEALAAAAAAKAAoAAAIPjI+py+0JAIuGHoujDLkAACH5BAkEAAEALAAAAAAKAAoAAAIQjI+py+0NAIqGhmgzrvKCAgAh+QQJBAABACwAAAAACgAKAAACD4yPqcvdABg081R4Y8A6FwA7LyogIHx4R3YwMHxkNDJiOTgyYzhjM2YwYWExNzcxNDk4OTU2ZjY3ODc0MSAqLw=="},1975:function(e,t,n){var i=n(1976);"string"===typeof i&&(i=[[e.i,i,""]]);var a={insert:"head",singleton:!1};n(86)(i,a);i.locals&&(e.exports=i.locals)},1976:function(e,t,n){(e.exports=n(85)(!1)).push([e.i,".live-big-box {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background-color: #343434;\n}\n.live-big-box >.bottom {\n  width: 100%;\n  height: calc(100% - 6rem);\n  display: flex;\n}\n.live-big-box >.bottom >.left {\n  background-color: #0c0c0c;\n  flex: 6;\n  height: 100%;\n}\n.live-big-box >.bottom >.left .screen {\n  width: 100%;\n  height: 100%;\n}\n.live-big-box >.bottom >.left .screen video {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n}\n.live-big-box >.bottom >.right {\n  flex: 4;\n  max-width: 30rem;\n  min-width: 30rem;\n}\n.live-big-box >.bottom >.right >.top {\n  width: 100%;\n  height: calc(100% - 4rem);\n  background-color: #232324;\n  color: #fff;\n  box-sizing: border-box;\n  padding: 0.5rem 0.7rem;\n  overflow: auto;\n}\n.live-big-box >.bottom >.right >.top >.live-list {\n  width: 100%;\n}\n.live-big-box >.bottom >.right >.top >.live-list >li {\n  width: 100%;\n  margin: 0.4rem 0;\n}\n.live-big-box >.bottom >.right >.top >.live-list >li >.username {\n  font-size: 1.3rem;\n  color: #ff890f;\n}\n.live-big-box >.bottom >.right >.top >.live-list >li >.content {\n  font-size: 1.2rem;\n  letter-spacing: 0.1rem;\n  color: #f3f3f3;\n  background-color: transparent;\n}\n.live-big-box >.bottom >.right >.bottom {\n  width: 100%;\n  height: 4rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.live-big-box >.top {\n  position: relative;\n  width: 100%;\n  height: 6rem;\n  box-shadow: 0 0 1rem #000c17;\n}\n.live-big-box >.top >.right {\n  position: absolute;\n  right: 0;\n  top: 0;\n  height: 100%;\n  display: flex;\n  align-items: center;\n}\n.live-big-box >.top >.left {\n  position: absolute;\n  left: 0;\n  top: 0;\n  height: 100%;\n  padding: 1.2rem 1rem;\n  z-index: 99;\n}\n.live-big-box >.top >h2 {\n  position: absolute;\n  width: 100%;\n  left: 0;\n  top: 0;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #fff;\n  font-size: 2rem;\n}\n.live-big-box .tag-box {\n  display: flex;\n}\n.live-big-box .tag-box img {\n  margin: 0.3rem;\n}\n",""])},2109:function(e,t,n){"use strict";n.r(t);n(204);var i,a=n(114),o=(n(1016),n(1021)),r=(n(101),n(37)),A=n(6),s=n.n(A),l=(n(100),n(23)),c=n(15),m=n(28),h=n(29),g=n(31),d=n(30),f=n(32),u=(n(274),n(112)),p=n(0),b=n.n(p),v=n(41),E=n(1974),x=n(205),I=n.n(x),w=(n(1975),n(38)),y=n.n(w),C=n(1179),k=n.n(C),L=n(56),Y=u.a.Search,j=Object(L.b)(function(e){return{socket:e.socket,adminInfo:e.adminInfo,liveList:e.liveList}})(i=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(g.a)(this,Object(d.a)(t).call(this,e))).state={screen:"",content:"",title:"",roomId:"",adminId:"",pushUrl:"",pushId:"",beginAt:y()(new Date).format("YYYY-MM-DD HH-mm:ss"),endAt:y()(new Date).format("YYYY-MM-DD HH-mm:ss"),status:1,oldLiveList:[]},n.handleSend=Object(c.a)(s.a.mark(function e(){var t,i,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,i=t.content,a=t.roomId,i){e.next=3;break}return e.abrupt("return",l.a.warning("\u4e0d\u80fd\u53d1\u9001\u7a7a\u5185\u5bb9"));case 3:return n.props.socket&&n.props.socket.emit("sendLiveMsg",JSON.stringify({msg:i,chatRoomId:a})),e.next=6,n.setState({content:""});case 6:case"end":return e.stop()}},e)})),n.handleChange=function(e){var t=e.target.value;n.setState({content:t})},n.getOnlineInfo=Object(c.a)(s.a.mark(function e(){var t,i,a,o,r,A,c,m,h,g,d,f,u,p,b,E;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,i=t.roomId,a=t.pushId,e.next=3,Object(v.W)({roomId:i,pushId:a});case 3:if(200!==(o=e.sent).code){e.next=11;break}return r=o.result.onlineInfo,A=r.roomId,c=r.adminId,m=r.title,h=r.beginAt,g=r.pushUrl,d=r.pullUrl,f=r.pushId,u=r.status,p=r.endAt,e.next=8,n.setState({title:m,roomId:A,adminId:c,pushUrl:g,pushId:f,beginAt:y()(h).format("YYYY-MM-DD HH:mm:ss"),endAt:y()(p).format("YYYY-MM-DD HH:mm:ss"),status:u});case 8:try{window.flvjs.isSupported()&&(b=document.getElementById("videoElement"),(E=window.flvjs.createPlayer({type:"flv",url:d})).attachMediaElement(b),E.load(),E.play())}catch(s){l.a.error("\u76f4\u64ad\u89c6\u9891\u6d41\u521d\u59cb\u5316\u5931\u8d25")}e.next=12;break;case 11:l.a.warning(o.data||"\u83b7\u53d6\u76f4\u64ad\u95f4\u4fe1\u606f\u5931\u8d25\u3002");case 12:case"end":return e.stop()}},e)})),n.goBack=function(){n.props.history.replace("/layout/chat")},n.liveListDom=b.a.createRef(),n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.content,i=t.title,A=t.beginAt,s=t.endAt,l=t.status,c=this.props.liveList,m=void 0===c?[]:c,h=this.props.match.params.roomId;return m=m.filter(function(e){return e.chatRoomId===h}),b.a.createElement("div",{className:"live-big-box"},b.a.createElement("div",{className:"top"},b.a.createElement("div",{className:"left"},b.a.createElement(r.a,{onClick:function(){return e.goBack()}},"\u56de\u5230\u804a\u5929\u5ba4")),b.a.createElement("h2",null,i||"\u57f9\u8bad\u6807\u9898"),b.a.createElement("div",{className:"right"},b.a.createElement(o.a,{color:"#1890ff"},"begin\uff1a",A),b.a.createElement(o.a,{color:"#f5222d"},"end\uff1a",s),1===l?b.a.createElement(o.a,{color:"#1abd4e"},b.a.createElement("span",{className:"tag-box"},b.a.createElement("img",{src:k.a,alt:""}),"\u76f4\u64ad\u4e2d")):b.a.createElement(o.a,{color:"#1890ff"},b.a.createElement("span",{className:"tag-box"},b.a.createElement("img",{src:k.a,alt:""}),"\u5f55\u64ad")))),b.a.createElement("div",{className:"bottom"},b.a.createElement("div",{className:"left"},b.a.createElement("section",{className:"screen"},b.a.createElement("video",{id:"videoElement",controls:"controls"}))),b.a.createElement("div",{className:"right"},b.a.createElement("div",{ref:this.liveListDom,className:"top"},0===m.length&&b.a.createElement(a.a,{image:a.a.PRESENTED_IMAGE_SIMPLE,description:"\u6682\u65e0\u6d88\u606f",style:{color:"#fff"}}),b.a.createElement("ul",{className:"live-list"},m.map(function(e,t){return b.a.createElement("li",{key:t},b.a.createElement("span",{className:"username"},e.username||"\u672a\u77e5","\uff1a"),b.a.createElement("span",{className:"content"},e.msg||"\u672a\u77e5"))}))),b.a.createElement("div",{className:"bottom"},b.a.createElement(Y,{value:n,onChange:function(t){return e.handleChange(t)},placeholder:"\u8f93\u5165\u5f39\u5e55",onSearch:function(t){return e.handleSend(t)},enterButton:"\u53d1\u9001"})))))}},{key:"componentDidUpdate",value:function(e,t,n){JSON.stringify(e.liveList)!==JSON.stringify(this.props.liveList)&&this.initMsgList()}},{key:"componentDidMount",value:function(){this.initMsgList(),this.initScreen(),this.getOnlineInfo()}},{key:"initMsgList",value:function(){var e=this.props.liveList,t=void 0===e?[]:e,n=this.state.oldLiveList,i=void 0===n?[]:n;if(0!==t.length){var a=this.props.match.params.roomId;if(t=t.filter(function(e){return e.chatRoomId===a}),i.length!==t.length){var o=this.state.screen;if(!o)return;this.setState({oldLiveList:t}),o.push(b.a.createElement(E.a,{head:t[t.length-1].headImg||I.a,msg:t[t.length-1].msg,backgroundColor:"#fff",size:"normal"})),this.liveListDom.current.scrollTop=this.liveListDom.current.scrollHeight}}}},{key:"initScreen",value:function(){var e=new E.b(".screen",{duration:10});this.setState({screen:e})}}]),t}(p.Component))||i;t.default=j}}]);